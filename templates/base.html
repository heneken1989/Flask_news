<!DOCTYPE html>
{% if seo_meta %}
<html lang="{{ seo_meta.language }}-{{ 'DK' if seo_meta.language == 'da' else 'GL' if seo_meta.language == 'kl' else 'US' }}" dir="ltr" class="resp_fonts">
{% else %}
<html lang="da-DK" dir="ltr" class="resp_fonts">
{% endif %}

    <head>
        {% block head %}
            {# SEO Meta Tags - Dynamic từ database #}
            {% if seo_meta %}
                {% from 'macros/seo_meta.html' import render_seo_meta, render_structured_data %}
                {{ render_seo_meta(seo_meta) }}
                
                {# Structured Data (JSON-LD) #}
                {% if structured_data %}
                    {{ render_structured_data(structured_data) }}
                {% endif %}
                
                {# Include CSS, scripts, và các phần khác từ head_content #}
                {% include 'partials/head_content.html' %}
            {% else %}
                {# Fallback: Dùng head.html cũ nếu không có seo_meta #}
                {% include 'partials/head.html' %}
            {% endif %}
        {% endblock %}
        
        {# Page-specific head content #}
        {% block extra_head %}{% endblock %}
    </head>

    <body class="{% block body_class %}l4 article site_sermitsiaq section_samfund iteras-paywall{% endblock %}" {% block body_attrs %}{% endblock %}>
        
        {# Google Tag Manager (noscript) #}
        <!-- Google Tag Manager (noscript) -->
        <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KXF2W8B"
        height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
        <!-- End Google Tag Manager (noscript) -->
        
        <script>
        document.addEventListener("DOMContentLoaded", (event) => {
            setScrollbarWidth();
            window.addEventListener('resize', setScrollbarWidth);
        });
        function setScrollbarWidth() {
            const root = document.querySelector(':root');
            const width = (window.innerWidth - document.body.offsetWidth < 21) ? window.innerWidth - document.body.offsetWidth : 15;
            root.style.setProperty('--lab-scrollbar-width', `${ width }px`);
        }
        </script>

        <a href="#main" class="skip-link">Jump to main content</a>

        {# Header - Reuse từ partial #}
        {% include 'partials/header.html' %}

        {# Main Content - Override trong child templates #}
        <main id="main">
            {% block content %}{% endblock %}
        </main>

        {# Footer - Reuse từ partial #}
        {% include 'partials/footer.html' %}

        {# Page-specific scripts - Override trong child templates #}
        {% block scripts %}{% endblock %}
    </body>
</html>

